#!/usr/bin/env python
# -*- coding: UTF-8 -*-
'''=================================================
@Project -> File   ：qiyangPythonCrawler -> zhaosw_招商网
@IDE    ：PyCharm
@Author ：Mr. cyh
@Date   ：2021-07-28 10:15
@Desc   ：
=================================================='''
from myJDBC.jdbc import mySqlJdbc
from util.httpTool import MyHttpToolUtil
from util.TOOL import MyToolUtil
from util.ioTool import MyIoToolUtil

httpTool = MyHttpToolUtil()
tool = MyToolUtil
ioTool = MyIoToolUtil
jdbc = mySqlJdbc()

children_list = [
    65,
    13,
    68,
    8,
    54,
    15,
    59,
    5,
    7,
    57,
    55,
]
dataBD = ""
dataBD_search_id = ""


def getSJ(href, text):
    sj_list = tool.getSjAllList(text)
    for sj in sj_list:
        sj_gs = jdbc.getSjGs(sj=sj, dataBD=dataBD)
        if sj_gs < 1:
            jdbc.inHnSJ(url=href, sj=sj, dataBD=dataBD)


def getxq(id):
    url = "https://www.zhaosw.com/product/list/henan1-{}"
    "https://www.zhaosw.com/product/list/henan1-1042787"
    html_Sele = httpTool.getSele_one_none(url.format(id))
    xpath_href = "//div[@class='product-item']/div[@class='product-inner']/a[2]/@href"
    href_list = set(html_Sele.xpath(xpath_href))

    for href in href_list:
        href_gs = jdbc.getUrlGs(url=href, dataBD=dataBD)
        if href_gs < 1:
            text_html = httpTool.getHtml_one_none(href)
            getSJ(href, text_html)

    # print(href_list)
    # print(type(href_list))
    # print(len(href_list))


if __name__ == '__main__':
    # getxq(1042787)
    # exit()

    for children in children_list:
        url = "https://www.zhaosw.com/product_category/children/{}".format(children)
        html_text = httpTool.getHtml_one_none(url=url)
        ReStr = "d\":(\d+)},"
        id_list = tool.getReStrAllList("", ReStr=ReStr, data=html_text)

        print(id_list)
        for id in id_list:
            jdbc.inIdSearch(IdSearch=id, dataBD=dataBD_search_id)
        # print(type(html_text))

"""
[{"path":"/product/list/141906","children":[{"path":"/product/list/1042787","name":"组合件及连接副","id":1042787},{"path":"/product/list/125754003","name":"光伏支架","id":125754003},{"path":"/product/list/1035458","name":"其他紧固件、连接件","id":1035458},{"path":"/product/list/1035459","name":"卡簧、挡圈","id":1035459},{"path":"/product/list/1035463","name":"铆钉","id":1035463},{"path":"/product/list/1035464","name":"销及键","id":1035464},{"path":"/product/list/1035465","name":"垫圈","id":1035465},{"path":"/product/list/1035466","name":"螺母","id":1035466},{"path":"/product/list/1035467","name":"螺钉","id":1035467},{"path":"/product/list/1035468","name":"螺栓","id":1035468},{"path":"/product/list/1036788","name":"螺柱","id":1036788},{"path":"/product/list/1210000567","name":"脱毛机","id":1210000567},{"path":"/product/list/1210000690","name":"刮吸泥机","id":1210000690},{"path":"/product/list/1210000732","name":"斜管（板）沉淀器","id":1210000732},{"path":"/product/list/1210000787","name":"防草布","id":1210000787},{"path":"/product/list/1210000824","name":"监控塔","id":1210000824},{"path":"/product/list/1210000825","name":"训练塔","id":1210000825},{"path":"/product/list/1210000826","name":"瞭望塔","id":1210000826},{"path":"/product/list/1210000827","name":"避雷塔","id":1210000827},{"path":"/product/list/1210000864","name":"袋式过滤器","id":1210000864},{"path":"/product/list/1210000910","name":"减速机","id":1210000910},{"path":"/product/list/1210000962","name":"泵管","id":1210000962},{"path":"/product/list/1210000975","name":"工业制冷设备","id":1210000975},{"path":"/product/list/1210001009","name":"锅炉","id":1210001009},{"path":"/product/list/1210001033","name":"防火材料","id":1210001033}],"name":"紧固件、连接件","id":141906},{"path":"/product/list/10446","children":[{"path":"/product/list/1036820","name":"混凝土泵车","id":1036820},{"path":"/product/list/1032498","name":"工程机械配件","id":1032498},{"path":"/product/list/1032499","name":"市政和环境卫生机械","id":1032499},{"path":"/product/list/1032500","name":"园林和高空作业机械","id":1032500},{"path":"/product/list/1032501","name":"钢筋和预应力机械","id":1032501},{"path":"/product/list/1032502","name":"装载机械","id":1032502},{"path":"/product/list/1032503","name":"路面机械","id":1032503},{"path":"/product/list/1032504","name":"推土机、铲运机","id":1032504},{"path":"/product/list/1032505","name":"桩工机械","id":1032505},{"path":"/product/list/1032506","name":"挖掘机械","id":1032506},{"path":"/product/list/10447","name":"起重机","id":10447},{"path":"/product/list/10448","name":"压实机械","id":10448},{"path":"/product/list/10449","name":"凿岩机械","id":10449},{"path":"/product/list/10450","name":"混凝土机械","id":10450},{"path":"/product/list/10451","name":"装修机械","id":10451},{"path":"/product/list/10452","name":"其他工程与建筑机械","id":10452},{"path":"/product/list/1210000327","name":"扒渣机","id":1210000327},{"path":"/product/list/1210000357","name":"焊网机、排焊机","id":1210000357},{"path":"/product/list/1210000470","name":"挖掘机","id":1210000470},{"path":"/product/list/1210000556","name":"开沟机","id":1210000556},{"path":"/product/list/1210000557","name":"开沟机","id":1210000557},{"path":"/product/list/1210000558","name":"滑模机","id":1210000558},{"path":"/product/list/1210000559","name":"水渠机","id":1210000559},{"path":"/product/list/1210000705","name":"洗轮机冲洗平台","id":1210000705},{"path":"/product/list/1210000709","name":"湿喷机","id":1210000709},{"path":"/product/list/1210000812","name":"双喷头湿喷机","id":1210000812},{"path":"/product/list/1210000813","name":"湿喷台车","id":1210000813},{"path":"/product/list/1210000814","name":"混凝土喷射机","id":1210000814},{"path":"/product/list/1210000815","name":"高压注浆机","id":1210000815},{"path":"/product/list/1210000816","name":"小型双液注浆机","id":1210000816},{"path":"/product/list/1210000817","name":"小型单液注浆机","id":1210000817},{"path":"/product/list/1210000818","name":"双液防爆注浆机","id":1210000818},{"path":"/product/list/1210000819","name":"双液注浆机","id":1210000819},{"path":"/product/list/1210000820","name":"液压湿喷机","id":1210000820},{"path":"/product/list/1210000821","name":"混凝土湿喷机","id":1210000821},{"path":"/product/list/1210000963","name":"全自动砖机","id":1210000963},{"path":"/product/list/1210000976","name":"防水施工设备","id":1210000976},{"path":"/product/list/1210000992","name":"砂浆喷涂设备","id":1210000992},{"path":"/product/list/1210001107","name":"锯边机","id":1210001107},{"path":"/product/list/1210001160","name":"破碎锤","id":1210001160}],"name":"工程机械、建筑机械","id":10446},{"path":"/product/list/138","children":[{"path":"/product/list/1032507","name":"其他农业机械","id":1032507},{"path":"/product/list/1032508","name":"农业实验设备","id":1032508},{"path":"/product/list/1032509","name":"施肥机械","id":1032509},{"path":"/product/list/1032510","name":"拖拉机","id":1032510},{"path":"/product/list/1032511","name":"场上作业机械","id":1032511},{"path":"/product/list/1032512","name":"收获机械","id":1032512},{"path":"/product/list/1032513","name":"排灌机械","id":1032513},{"path":"/product/list/1032514","name":"植保机械","id":1032514},{"path":"/product/list/1032515","name":"种植机械","id":1032515},{"path":"/product/list/1032516","name":"土壤耕整机械","id":1032516},{"path":"/product/list/10057","name":"粮食加工设备","id":10057},{"path":"/product/list/10058","name":"饲料加工设备","id":10058},{"path":"/product/list/10059","name":"屠宰及肉类初加工设备","id":10059},{"path":"/product/list/10098","name":"食用油加工设备","id":10098},{"path":"/product/list/129","name":"林业机械","id":129},{"path":"/product/list/130","name":"渔业机械","id":130},{"path":"/product/list/131","name":"畜牧、养殖业机械","id":131},{"path":"/product/list/137","name":"肥料加工设备","id":137},{"path":"/product/list/10122","name":"农机配件","id":10122},{"path":"/product/list/1210000856","name":"饲料颗粒机","id":1210000856}],"name":"农业机械","id":138},{"path":"/product/list/86","children":[{"path":"/product/list/1036838","name":"热熔胶机","id":1036838},{"path":"/product/list/124190011","name":"手动打包机","id":124190011},{"path":"/product/list/1045327","name":"热收缩包装机","id":1045327},{"path":"/product/list/1033570","name":"条码设备","id":1033570},{"path":"/product/list/1036400","name":"包装机械配附件","id":1036400},{"path":"/product/list/1036401","name":"成型机","id":1036401},{"path":"/product/list/1032568","name":"其他包装设备","id":1032568},{"path":"/product/list/1032569","name":"包装生产线","id":1032569},{"path":"/product/list/1032570","name":"包装辅助设备","id":1032570},{"path":"/product/list/1032571","name":"集装机械","id":1032571},{"path":"/product/list/1032572","name":"全自动打包机","id":1032572},{"path":"/product/list/1032573","name":"杀菌机、干燥机","id":1032573},{"path":"/product/list/1032574","name":"清洗机械","id":1032574},{"path":"/product/list/1032575","name":"贴标机械","id":1032575},{"path":"/product/list/1032576","name":"多功能包装机","id":1032576},{"path":"/product/list/1032577","name":"裹包机械","id":1032577},{"path":"/product/list/1032578","name":"封口机械","id":1032578},{"path":"/product/list/1032579","name":"灌装机械","id":1032579},{"path":"/product/list/1032580","name":"充填机械","id":1032580},{"path":"/product/list/124194013","name":"半自动打包机","id":124194013},{"path":"/product/list/1032928","name":"打码机、喷码机","id":1032928},{"path":"/product/list/1210000353","name":"激光打标机","id":1210000353},{"path":"/product/list/1210000456","name":"金检机","id":1210000456},{"path":"/product/list/1210000457","name":"在线称重设备","id":1210000457},{"path":"/product/list/1210000478","name":"手套包装机","id":1210000478},{"path":"/product/list/1210000479","name":"日用品包装机","id":1210000479},{"path":"/product/list/1210000560","name":"旋盖机","id":1210000560},{"path":"/product/list/1210000703","name":"金属检测机","id":1210000703},{"path":"/product/list/1210000744","name":"铝箔封口机","id":1210000744},{"path":"/product/list/1210000875","name":"检重秤","id":1210000875},{"path":"/product/list/1210000961","name":"喷码机、打码机","id":1210000961},{"path":"/product/list/1210001021","name":"机械手","id":1210001021},{"path":"/product/list/1210001022","name":"智能生产线","id":1210001022},{"path":"/product/list/1210001024","name":"智能产线","id":1210001024}],"name":"包装设备","id":86},{"path":"/product/list/10095","children":[{"path":"/product/list/1036589","name":"食品杀菌设备","id":1036589},{"path":"/product/list/1032519","name":"罐头食品加工设备","id":1032519},{"path":"/product/list/1032520","name":"豆制品加工设备","id":1032520},{"path":"/product/list/1032521","name":"调味品加工设备","id":1032521},{"path":"/product/list/1032522","name":"休闲食品加工设备","id":1032522},{"path":"/product/list/1032523","name":"冷冻食品加工设备","id":1032523},{"path":"/product/list/1035619","name":"食品烘焙设备","id":1035619},{"path":"/product/list/10096","name":"果蔬加工设备","id":10096},{"path":"/product/list/10097","name":"饮料生产设备","id":10097},{"path":"/product/list/1036402","name":"烟草配附件","id":1036402},{"path":"/product/list/10099","name":"肉制品加工设备","id":10099},{"path":"/product/list/1036403","name":"食品包装机械","id":1036403},{"path":"/product/list/10100","name":"其他食品、饮料加工设备","id":10100},{"path":"/product/list/1036404","name":"保鲜冷藏设备","id":1036404},{"path":"/product/list/1036405","name":"酿酒设备","id":1036405},{"path":"/product/list/1036406","name":"乳品机械","id":1036406},{"path":"/product/list/1036407","name":"米面机械","id":1036407},{"path":"/product/list/1036408","name":"糖果机械","id":1036408},{"path":"/product/list/1036409","name":"饼干机械","id":1036409},{"path":"/product/list/1045450","name":"饮食加工设备配附件","id":1045450},{"path":"/product/list/221","name":"炊事设备","id":221},{"path":"/product/list/1210000345","name":"果蔬专用切丝机","id":1210000345},{"path":"/product/list/1210000348","name":"灭菌设备","id":1210000348},{"path":"/product/list/1210000471","name":"回转火锅设备","id":1210000471},{"path":"/product/list/1210000472","name":"旋转寿司设备","id":1210000472},{"path":"/product/list/1210000602","name":"脱毛机1","id":1210000602},{"path":"/product/list/1210000608","name":"厨房炊具","id":1210000608},{"path":"/product/list/1210001116","name":"豆腐机","id":1210001116},{"path":"/product/list/1210001117","name":"腐竹机","id":1210001117},{"path":"/product/list/1210001118","name":"豆腐皮机","id":1210001118},{"path":"/product/list/1210001158","name":"中央厨房设备","id":1210001158}],"name":"食品、饮料加工及餐饮行业设备","id":10095},{"path":"/product/list/141907","children":[{"path":"/product/list/1035310","name":"放料阀","id":1035310},{"path":"/product/list/1035311","name":"气动阀","id":1035311},{"path":"/product/list/1035312","name":"膨胀阀","id":1035312},{"path":"/product/list/1035314","name":"角阀","id":1035314},{"path":"/product/list/1035315","name":"燃气阀","id":1035315},{"path":"/product/list/1035316","name":"脚踏阀","id":1035316},{"path":"/product/list/1035317","name":"针阀","id":1035317},{"path":"/product/list/1035318","name":"排气阀","id":1035318},{"path":"/product/list/1035319","name":"流量控制阀","id":1035319},{"path":"/product/list/1035320","name":"阀体","id":1035320},{"path":"/product/list/1043287","name":"溢流阀","id":1043287},{"path":"/product/list/1035656","name":"阀门配件","id":1035656},{"path":"/product/list/1043090","name":"电动阀","id":1043090},{"path":"/product/list/1034460","name":"手动阀","id":1034460},{"path":"/product/list/1032417","name":"其他阀门","id":1032417},{"path":"/product/list/1032418","name":"换向阀","id":1032418},{"path":"/product/list/1032419","name":"电磁阀","id":1032419},{"path":"/product/list/1032420","name":"排污阀","id":1032420},{"path":"/product/list/1032421","name":"底阀","id":1032421},{"path":"/product/list/1032422","name":"调节阀","id":1032422},{"path":"/product/list/1032423","name":"疏水阀","id":1032423},{"path":"/product/list/1032424","name":"安全阀","id":1032424},{"path":"/product/list/1032425","name":"减压阀","id":1032425},{"path":"/product/list/1032426","name":"止回阀","id":1032426},{"path":"/product/list/1032427","name":"蝶阀","id":1032427},{"path":"/product/list/1032428","name":"球阀","id":1032428},{"path":"/product/list/1032429","name":"旋塞阀","id":1032429},{"path":"/product/list/1032430","name":"隔膜阀","id":1032430},{"path":"/product/list/1032431","name":"柱塞阀","id":1032431},{"path":"/product/list/1032432","name":"仪表阀","id":1032432},{"path":"/product/list/1032433","name":"节流阀","id":1032433},{"path":"/product/list/1032434","name":"截止阀","id":1032434},{"path":"/product/list/1032435","name":"闸阀","id":1032435},{"path":"/product/list/1210000292","name":"泵阀","id":1210000292},{"path":"/product/list/1210000315","name":"喷射阀","id":1210000315},{"path":"/product/list/1210000765","name":"泰科暧通阀门","id":1210000765},{"path":"/product/list/1210000766","name":"泰科水系统阀门","id":1210000766},{"path":"/product/list/1210000767","name":"泰科消防阀门","id":1210000767},{"path":"/product/list/1210000768","name":"泰科水力控制阀门","id":1210000768},{"path":"/product/list/1210000769","name":"泰科铜阀门","id":1210000769},{"path":"/product/list/1210000770","name":"泰科化工阀门","id":1210000770},{"path":"/product/list/1210000771","name":"通风蝶阀系列","id":1210000771},{"path":"/product/list/1210000772","name":"物体粉料阀系列","id":1210000772},{"path":"/product/list/1210000773","name":"冶金非标阀系列","id":1210000773},{"path":"/product/list/1210000774","name":"污水处理阀系列","id":1210000774},{"path":"/product/list/1210000876","name":"全焊接球阀","id":1210000876},{"path":"/product/list/1210001109","name":"水利控制阀","id":1210001109}],"name":"阀门","id":141907},{"path":"/product/list/1425","children":[{"path":"/product/list/1032456","name":"其他泵","id":1032456},{"path":"/product/list/124000010","name":"喷射泵","id":124000010},{"path":"/product/list/1032458","name":"往复泵","id":1032458},{"path":"/product/list/1032459","name":"真空泵","id":1032459},{"path":"/product/list/1032460","name":"转子泵","id":1032460},{"path":"/product/list/1032461","name":"混流泵","id":1032461},{"path":"/product/list/1032462","name":"旋涡泵","id":1032462},{"path":"/product/list/1032467","name":"离心泵","id":1032467},{"path":"/product/list/1035324","name":"轴流泵","id":1035324},{"path":"/product/list/1035325","name":"自吸泵","id":1035325},{"path":"/product/list/1035326","name":"屏蔽泵","id":1035326},{"path":"/product/list/1035657","name":"泵配件","id":1035657},{"path":"/product/list/1210000342","name":"排污泵","id":1210000342},{"path":"/product/list/1210000451","name":"液氨泵","id":1210000451},{"path":"/product/list/1210000452","name":"液氨输送泵","id":1210000452},{"path":"/product/list/1210000453","name":"海水淡化泵","id":1210000453},{"path":"/product/list/1210000454","name":"二氧化碳泵","id":1210000454},{"path":"/product/list/1210000455","name":"高压泵","id":1210000455},{"path":"/product/list/1210000670","name":"潜水排污泵","id":1210000670},{"path":"/product/list/1210000829","name":"卫生泵","id":1210000829},{"path":"/product/list/1210000909","name":"漩涡式气泵","id":1210000909}],"name":"泵","id":1425},{"path":"/product/list/1422","children":[{"path":"/product/list/1042435","name":"风口","id":1042435},{"path":"/product/list/1034313","name":"其他风机、排风设备","id":1034313},{"path":"/product/list/1034314","name":"风管","id":1034314},{"path":"/product/list/1034315","name":"风叶","id":1034315},{"path":"/product/list/1034316","name":"风机盘管","id":1034316},{"path":"/product/list/1034317","name":"离子风机","id":1034317},{"path":"/product/list/1034319","name":"风幕机","id":1034319},{"path":"/product/list/1034320","name":"工业风扇","id":1034320},{"path":"/product/list/1034321","name":"通风机","id":1034321},{"path":"/product/list/1034322","name":"鼓风机","id":1034322},{"path":"/product/list/1035663","name":"风机、排风设备配件","id":1035663},{"path":"/product/list/1210000922","name":"空调配件","id":1210000922}],"name":"风机、排风设备","id":1422}]



"""
